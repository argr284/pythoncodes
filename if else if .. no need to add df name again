import numpy as np
import pandas as pd

def if_else_np(df, *args):
    """
    df: pandas dataframe
    args: alternating condition (string), choice (string literal, number, or Series)
    last arg is optional default
    """

    # Default if odd number of args
    default = None
    if len(args) % 2 != 0:
        default = args[-1]
        args = args[:-1]

    conditions = args[::2]
    choices = args[1::2]

    # Evaluate conditions using df.eval()
    cond_eval = [df.eval(cond) if isinstance(cond, str) else cond for cond in conditions]

    # Prepare choices
    choice_eval = []
    for ch in choices:
        if isinstance(ch, pd.Series):
            choice_eval.append(ch)
        elif isinstance(ch, str):
            if ch in df.columns:
                choice_eval.append(df[ch])
            else:
                choice_eval.append(ch)  # Treat as literal string
        else:
            choice_eval.append(ch)

    return np.select(cond_eval, choice_eval, default=default)